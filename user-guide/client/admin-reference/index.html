<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://github.com/airbusgeo/geocube-client-python/user-guide/client/admin-reference/" />
      <link rel="shortcut icon" href="../../../img/favicon.ico" />
    <title>Admin - Geocube Client Python</title>
    <link rel="stylesheet" href="../../../css/theme.css" />
    <link rel="stylesheet" href="../../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../../../assets/_mkdocstrings.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Admin";
        var mkdocs_page_input_path = "user-guide/client/admin-reference.md";
        var mkdocs_page_url = "/airbusgeo/geocube-client-python/user-guide/client/admin-reference/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../../.." class="icon icon-home"> Geocube Client Python
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../../quickstart/">Getting started</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">User guide</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../../tutorials/">Tutorials</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" >Client</a>
    <ul class="current">
                <li class="toctree-l2"><a class="reference internal" href="../client-reference/">Basic access</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../consolidater-reference/">Consolidater</a>
                </li>
                <li class="toctree-l2 current"><a class="reference internal current" href="#">Admin</a>
    <ul class="current">
    <li class="toctree-l3"><a class="reference internal" href="#geocube.Admin">Admin</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#geocube.Admin.__init__">__init__</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#geocube.Admin.admin_delete_datasets">admin_delete_datasets</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#geocube.Admin.admin_tidy">admin_tidy</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#geocube.Admin.admin_update_datasets">admin_update_datasets</a>
    </li>
    </ul>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >Entities</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../entities/variable-reference/">Variable</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../entities/record-reference/">Records</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../entities/dataset-reference/">Dataset & Container</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../entities/layout-reference/">Layout & Grid</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../entities/job-reference/">Job</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >GetCube</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../getcube/tile-reference/">Tile</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../getcube/cubeparams-reference/">CubeParams</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../getcube/cubemetadata-reference/">CubeMetadata</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../grpc/">GRPC Interface</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">About</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/help/">Getting help</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/CONTRIBUTING/">Contributing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/license/">License</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../../about/release-notes/">Release Notes</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../..">Geocube Client Python</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">User guide</li>
          <li class="breadcrumb-item">Client</li>
      <li class="breadcrumb-item active">Admin</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="admin">Admin</h1>


<div class="doc doc-object doc-class">



<a id="geocube.Admin"></a>
    <div class="doc doc-contents first">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="geocube.Consolidater" href="../consolidater-reference/#geocube.Consolidater">Consolidater</a></code></p>








              <details class="quote">
                <summary>Source code in <code>geocube/admin.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Admin</span><span class="p">(</span><span class="n">Consolidater</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">secure</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">api_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise the connexion to the Geocube Server</span>

<span class="sd">        Args:</span>
<span class="sd">            uri: of the Geocube Server</span>
<span class="sd">            secure: True to use a TLS Connexion</span>
<span class="sd">            api_key: (optional) API Key if Geocube Server is secured using a bearer authentication</span>
<span class="sd">            verbose: display the version of the Geocube Server</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">secure</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">admin_stub</span> <span class="o">=</span> <span class="n">Stub</span><span class="p">(</span><span class="n">admin_pb2_grpc</span><span class="o">.</span><span class="n">AdminStub</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">))</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">set_timeout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">timeout_sec</span><span class="p">:</span> <span class="nb">float</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">set_timeout</span><span class="p">(</span><span class="n">timeout_sec</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">admin_stub</span><span class="o">.</span><span class="n">timeout</span> <span class="o">=</span> <span class="n">timeout_sec</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">admin_tidy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aois</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">records</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">variables</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">instances</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                   <span class="n">containers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">consolidation_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">simulate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Admin function to tidy the Geocube Database.</span>
<span class="sd">        Remove all the entities that are not linked to any dataset.</span>
<span class="sd">        Should be used with caution when no ingestion or indexation task is in progress.</span>

<span class="sd">        Args:</span>
<span class="sd">            aois: remove the pending AOI</span>
<span class="sd">            records: remove the pending Records</span>
<span class="sd">            variables: remove the pending Variables</span>
<span class="sd">            instances: remove the pending Instances</span>
<span class="sd">            containers: remove the pending Containers</span>
<span class="sd">            consolidation_params: remove the pending ConsolidationParams</span>
<span class="sd">            simulate: if True no operation is performed. Only the number of entities that would have been deleted</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_tidy</span><span class="p">(</span><span class="n">aois</span><span class="p">,</span> <span class="n">records</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">instances</span><span class="p">,</span> <span class="n">containers</span><span class="p">,</span> <span class="n">consolidation_params</span><span class="p">,</span> <span class="n">simulate</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">admin_update_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">VariableInstance</span><span class="p">],</span>
                              <span class="n">records</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">Record</span><span class="p">]],</span>
                              <span class="n">dformat</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">min_out</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">max_out</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                              <span class="n">exponent</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">simulate</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Admin function to update some sensitive information of datasets referenced by an instance and a list of records</span>

<span class="sd">        Args:</span>
<span class="sd">            instance: select the datasets that are referenced by this instance</span>
<span class="sd">            records: select the datasets that are referenced by these records</span>
<span class="sd">            dformat: new dataformat</span>
<span class="sd">            min_out: new min_out</span>
<span class="sd">            max_out: new max_out</span>
<span class="sd">            exponent: new exponent</span>
<span class="sd">            simulate: if True, no operation is performed. Only display the datasets that would have been updated.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_admin_update_datasets</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">records</span><span class="p">,</span> <span class="n">dformat</span><span class="p">,</span> <span class="n">min_out</span><span class="p">,</span> <span class="n">max_out</span><span class="p">,</span> <span class="n">exponent</span><span class="p">,</span> <span class="n">simulate</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">admin_delete_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instances</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">VariableInstance</span><span class="p">]],</span>
                              <span class="n">records</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">Record</span><span class="p">]],</span>
                              <span class="n">file_patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                              <span class="n">execution_level</span><span class="p">:</span> <span class="n">entities</span><span class="o">.</span><span class="n">ExecutionLevel</span> <span class="o">=</span> <span class="n">entities</span><span class="o">.</span><span class="n">ExecutionLevel</span><span class="o">.</span><span class="n">STEP_BY_STEP_CRITICAL</span><span class="p">,</span>
                              <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">allow_empty_instances</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_empty_records</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">entities</span><span class="o">.</span><span class="n">Job</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Admin function to delete datasets that are referenced by a list of instances and a list of records.</span>
<span class="sd">        This function is provided without any guaranties of service continuity.</span>
<span class="sd">        In the future, a secured function will be provided to safely delete datasets.</span>

<span class="sd">        Args:</span>
<span class="sd">            instances: select all the datasets referenced by these instances.</span>
<span class="sd">            records: select all the datasets referenced by these records.</span>
<span class="sd">            file_patterns: select all the datasets with on of the given file patterns</span>
<span class="sd">                (support * and ? for all or any characters and trailing (?i) for case-insensitiveness)</span>
<span class="sd">            execution_level: see entities.ExecutionLevel.</span>
<span class="sd">            job_name: [optional] gives a name to the job, otherwise, a name will be automatically generated</span>
<span class="sd">            allow_empty_instances: [optional] allows instances to be empty.</span>
<span class="sd">                @warning It means that the job will delete all the instances for the given records.</span>
<span class="sd">            allow_empty_records: [optional] allows records to be empty.</span>
<span class="sd">                @warning It means that the job will delete all the records for the given instances.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_delete_datasets</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">records</span><span class="p">,</span> <span class="n">file_patterns</span><span class="p">,</span>  <span class="n">execution_level</span><span class="p">,</span>
                                           <span class="n">job_name</span><span class="p">,</span> <span class="n">allow_empty_instances</span><span class="p">,</span> <span class="n">allow_empty_records</span><span class="p">)</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">catch_rpc_error</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_admin_tidy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aois</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">records</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">variables</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">instances</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
                    <span class="n">containers</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">consolidation_params</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">simulate</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">admin_stub</span><span class="o">.</span><span class="n">TidyDB</span><span class="p">(</span><span class="n">admin_pb2</span><span class="o">.</span><span class="n">TidyDBRequest</span><span class="p">(</span>
            <span class="n">PendingAOIs</span><span class="o">=</span><span class="n">aois</span><span class="p">,</span> <span class="n">PendingRecords</span><span class="o">=</span><span class="n">records</span><span class="p">,</span> <span class="n">PendingVariables</span><span class="o">=</span><span class="n">variables</span><span class="p">,</span> <span class="n">PendingInstances</span><span class="o">=</span><span class="n">instances</span><span class="p">,</span>
            <span class="n">PendingContainers</span><span class="o">=</span><span class="n">containers</span><span class="p">,</span> <span class="n">PendingParams</span><span class="o">=</span><span class="n">consolidation_params</span><span class="p">,</span> <span class="n">Simulate</span><span class="o">=</span><span class="n">simulate</span>
        <span class="p">))</span>
        <span class="k">if</span> <span class="n">simulate</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulation:&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> aois deleted</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> records deleted</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> variables deleted</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> instances deleted</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> containers deleted</span><span class="se">\n</span><span class="s2">&quot;</span>
              <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">NbAOIs</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">NbRecords</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">NbVariables</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">NbInstances</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">NbContainers</span><span class="p">))</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">catch_rpc_error</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_admin_update_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">VariableInstance</span><span class="p">],</span>
                               <span class="n">records</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">Record</span><span class="p">]],</span>
                               <span class="n">dformat</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">min_out</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">max_out</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                               <span class="n">exponent</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">simulate</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">admin_stub</span><span class="o">.</span><span class="n">UpdateDatasets</span><span class="p">(</span><span class="n">admin_pb2</span><span class="o">.</span><span class="n">UpdateDatasetsRequest</span><span class="p">(</span>
            <span class="n">simulate</span><span class="o">=</span><span class="n">simulate</span><span class="p">,</span> <span class="n">instance_id</span><span class="o">=</span><span class="n">entities</span><span class="o">.</span><span class="n">get_id</span><span class="p">(</span><span class="n">instance</span><span class="p">),</span>
            <span class="n">record_ids</span><span class="o">=</span><span class="n">entities</span><span class="o">.</span><span class="n">get_ids</span><span class="p">(</span><span class="n">records</span><span class="p">),</span>
            <span class="n">dformat</span><span class="o">=</span><span class="n">entities</span><span class="o">.</span><span class="n">DataFormat</span><span class="o">.</span><span class="n">from_user</span><span class="p">(</span><span class="n">dformat</span><span class="p">)</span><span class="o">.</span><span class="n">to_pb</span><span class="p">(),</span>
            <span class="n">real_min_value</span><span class="o">=</span><span class="n">min_out</span><span class="p">,</span> <span class="n">real_max_value</span><span class="o">=</span><span class="n">max_out</span><span class="p">,</span> <span class="n">exponent</span><span class="o">=</span><span class="n">exponent</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">simulate</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Simulation:&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">count</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> : </span><span class="si">{}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">count</span><span class="p">))</span>

    <span class="nd">@utils</span><span class="o">.</span><span class="n">catch_rpc_error</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_admin_delete_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instances</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">VariableInstance</span><span class="p">]],</span>
                               <span class="n">records</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">Record</span><span class="p">]],</span>
                               <span class="n">file_patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
                               <span class="n">execution_level</span><span class="p">:</span> <span class="n">entities</span><span class="o">.</span><span class="n">ExecutionLevel</span><span class="p">,</span>
                               <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">allow_empty_instances</span><span class="p">,</span> <span class="n">allow_empty_records</span><span class="p">)</span> \
            <span class="o">-&gt;</span> <span class="n">entities</span><span class="o">.</span><span class="n">Job</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">allow_empty_records</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;DeleteDataset: records is empty, but it has not been allowed. &quot;</span>
                             <span class="s2">&quot;Empty records means that all the datasets for the given instances are about to be &quot;</span>
                             <span class="s2">&quot;deleted. If this is what is wanted, please set allow_empty_records=True&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">allow_empty_instances</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;DeleteDataset: instances is empty, but it has not been allowed. &quot;</span>
                             <span class="s2">&quot;Empty instances means that all the datasets for the given records are about to be &quot;</span>
                             <span class="s2">&quot;deleted. If this is what is wanted, please set allow_empty_instances=True&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">file_patterns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_patterns</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">file_patterns</span> <span class="o">=</span> <span class="p">[</span><span class="n">file_patterns</span><span class="p">]</span>
            <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">file_patterns</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">instances</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;this job may be about to delete the whole database&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">execution_level</span> <span class="o">==</span> <span class="n">entities</span><span class="o">.</span><span class="n">ExecutionLevel</span><span class="o">.</span><span class="n">ASYNCHRONOUS</span> <span class="ow">or</span> \
                    <span class="n">execution_level</span> <span class="o">==</span> <span class="n">entities</span><span class="o">.</span><span class="n">ExecutionLevel</span><span class="o">.</span><span class="n">SYNCHRONOUS</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;I cannot allow that in a non-interactive execution_level. &quot;</span>
                                 <span class="s2">&quot;Please use execution_level == entities.ExecutionLevel.STEP_BY_STEP_CRITICAL.&quot;</span><span class="p">)</span>

        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">admin_stub</span><span class="o">.</span><span class="n">DeleteDatasets</span><span class="p">(</span><span class="n">admin_pb2</span><span class="o">.</span><span class="n">DeleteDatasetsRequest</span><span class="p">(</span>
            <span class="n">job_name</span><span class="o">=</span><span class="n">job_name</span> <span class="k">if</span> <span class="n">job_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="sa">f</span><span class="s2">&quot;Deletion_</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">records</span><span class="p">)</span><span class="si">}</span><span class="s2">_records&quot;</span><span class="p">,</span>
            <span class="n">execution_level</span><span class="o">=</span><span class="n">execution_level</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">instance_ids</span><span class="o">=</span><span class="n">entities</span><span class="o">.</span><span class="n">get_ids</span><span class="p">(</span><span class="n">instances</span><span class="p">),</span> <span class="n">record_ids</span><span class="o">=</span><span class="n">entities</span><span class="o">.</span><span class="n">get_ids</span><span class="p">(</span><span class="n">records</span><span class="p">),</span>
            <span class="n">dataset_patterns</span><span class="o">=</span><span class="n">file_patterns</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">entities</span><span class="o">.</span><span class="n">Job</span><span class="o">.</span><span class="n">from_pb</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stub</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">job</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">









<div class="doc doc-object doc-function">


<h2 id="geocube.Admin.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">secure</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">api_key</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Initialise the connexion to the Geocube Server</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>uri</code></b>
                  (<code><span title="str">str</span></code>)
              –
              <div class="doc-md-description">
                <p>of the Geocube Server</p>
              </div>
            </li>
            <li>
              <b><code>secure</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>True to use a TLS Connexion</p>
              </div>
            </li>
            <li>
              <b><code>api_key</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>&#39;&#39;</code>
)
              –
              <div class="doc-md-description">
                <p>(optional) API Key if Geocube Server is secured using a bearer authentication</p>
              </div>
            </li>
            <li>
              <b><code>verbose</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>display the version of the Geocube Server</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>geocube/admin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">uri</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">secure</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">api_key</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialise the connexion to the Geocube Server</span>

<span class="sd">    Args:</span>
<span class="sd">        uri: of the Geocube Server</span>
<span class="sd">        secure: True to use a TLS Connexion</span>
<span class="sd">        api_key: (optional) API Key if Geocube Server is secured using a bearer authentication</span>
<span class="sd">        verbose: display the version of the Geocube Server</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">secure</span><span class="p">,</span> <span class="n">api_key</span><span class="p">,</span> <span class="n">verbose</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">admin_stub</span> <span class="o">=</span> <span class="n">Stub</span><span class="p">(</span><span class="n">admin_pb2_grpc</span><span class="o">.</span><span class="n">AdminStub</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_channel</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="geocube.Admin.admin_delete_datasets" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">admin_delete_datasets</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">records</span><span class="p">,</span> <span class="n">file_patterns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">execution_level</span><span class="o">=</span><span class="n">entities</span><span class="o">.</span><span class="n">ExecutionLevel</span><span class="o">.</span><span class="n">STEP_BY_STEP_CRITICAL</span><span class="p">,</span> <span class="n">job_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">allow_empty_instances</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_empty_records</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Admin function to delete datasets that are referenced by a list of instances and a list of records.
This function is provided without any guaranties of service continuity.
In the future, a secured function will be provided to safely delete datasets.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>instances</code></b>
                  (<code><span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="geocube.entities.VariableInstance" href="../../entities/variable-reference/#geocube.entities.VariableInstance">VariableInstance</a>]]</code>)
              –
              <div class="doc-md-description">
                <p>select all the datasets referenced by these instances.</p>
              </div>
            </li>
            <li>
              <b><code>records</code></b>
                  (<code><span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="geocube.entities.Record" href="../../entities/record-reference/#geocube.entities.Record">Record</a>]]</code>)
              –
              <div class="doc-md-description">
                <p>select all the datasets referenced by these records.</p>
              </div>
            </li>
            <li>
              <b><code>file_patterns</code></b>
                  (<code><span title="typing.List">List</span>[<span title="str">str</span>]</code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>select all the datasets with on of the given file patterns
(support * and ? for all or any characters and trailing (?i) for case-insensitiveness)</p>
              </div>
            </li>
            <li>
              <b><code>execution_level</code></b>
                  (<code><span title="geocube.entities.ExecutionLevel">ExecutionLevel</span></code>, default:
                      <code><span title="geocube.entities.ExecutionLevel.STEP_BY_STEP_CRITICAL">STEP_BY_STEP_CRITICAL</span></code>
)
              –
              <div class="doc-md-description">
                <p>see entities.ExecutionLevel.</p>
              </div>
            </li>
            <li>
              <b><code>job_name</code></b>
                  (<code><span title="str">str</span></code>, default:
                      <code>None</code>
)
              –
              <div class="doc-md-description">
                <p>[optional] gives a name to the job, otherwise, a name will be automatically generated</p>
              </div>
            </li>
            <li>
              <b><code>allow_empty_instances</code></b>
              –
              <div class="doc-md-description">
                <p>[optional] allows instances to be empty.
@warning It means that the job will delete all the instances for the given records.</p>
              </div>
            </li>
            <li>
              <b><code>allow_empty_records</code></b>
              –
              <div class="doc-md-description">
                <p>[optional] allows records to be empty.
@warning It means that the job will delete all the records for the given instances.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>geocube/admin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">admin_delete_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instances</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">VariableInstance</span><span class="p">]],</span>
                          <span class="n">records</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">Record</span><span class="p">]],</span>
                          <span class="n">file_patterns</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                          <span class="n">execution_level</span><span class="p">:</span> <span class="n">entities</span><span class="o">.</span><span class="n">ExecutionLevel</span> <span class="o">=</span> <span class="n">entities</span><span class="o">.</span><span class="n">ExecutionLevel</span><span class="o">.</span><span class="n">STEP_BY_STEP_CRITICAL</span><span class="p">,</span>
                          <span class="n">job_name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">allow_empty_instances</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_empty_records</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> \
        <span class="o">-&gt;</span> <span class="n">entities</span><span class="o">.</span><span class="n">Job</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Admin function to delete datasets that are referenced by a list of instances and a list of records.</span>
<span class="sd">    This function is provided without any guaranties of service continuity.</span>
<span class="sd">    In the future, a secured function will be provided to safely delete datasets.</span>

<span class="sd">    Args:</span>
<span class="sd">        instances: select all the datasets referenced by these instances.</span>
<span class="sd">        records: select all the datasets referenced by these records.</span>
<span class="sd">        file_patterns: select all the datasets with on of the given file patterns</span>
<span class="sd">            (support * and ? for all or any characters and trailing (?i) for case-insensitiveness)</span>
<span class="sd">        execution_level: see entities.ExecutionLevel.</span>
<span class="sd">        job_name: [optional] gives a name to the job, otherwise, a name will be automatically generated</span>
<span class="sd">        allow_empty_instances: [optional] allows instances to be empty.</span>
<span class="sd">            @warning It means that the job will delete all the instances for the given records.</span>
<span class="sd">        allow_empty_records: [optional] allows records to be empty.</span>
<span class="sd">            @warning It means that the job will delete all the records for the given instances.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_delete_datasets</span><span class="p">(</span><span class="n">instances</span><span class="p">,</span> <span class="n">records</span><span class="p">,</span> <span class="n">file_patterns</span><span class="p">,</span>  <span class="n">execution_level</span><span class="p">,</span>
                                       <span class="n">job_name</span><span class="p">,</span> <span class="n">allow_empty_instances</span><span class="p">,</span> <span class="n">allow_empty_records</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="geocube.Admin.admin_tidy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">admin_tidy</span><span class="p">(</span><span class="n">aois</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">records</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">variables</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">instances</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">containers</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">consolidation_params</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">simulate</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Admin function to tidy the Geocube Database.
Remove all the entities that are not linked to any dataset.
Should be used with caution when no ingestion or indexation task is in progress.</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>aois</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>remove the pending AOI</p>
              </div>
            </li>
            <li>
              <b><code>records</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>remove the pending Records</p>
              </div>
            </li>
            <li>
              <b><code>variables</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>remove the pending Variables</p>
              </div>
            </li>
            <li>
              <b><code>instances</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>remove the pending Instances</p>
              </div>
            </li>
            <li>
              <b><code>containers</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>remove the pending Containers</p>
              </div>
            </li>
            <li>
              <b><code>consolidation_params</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>False</code>
)
              –
              <div class="doc-md-description">
                <p>remove the pending ConsolidationParams</p>
              </div>
            </li>
            <li>
              <b><code>simulate</code></b>
                  (<code><span title="bool">bool</span></code>, default:
                      <code>True</code>
)
              –
              <div class="doc-md-description">
                <p>if True no operation is performed. Only the number of entities that would have been deleted</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>geocube/admin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">admin_tidy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">aois</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">records</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">variables</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">instances</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
               <span class="n">containers</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">consolidation_params</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">simulate</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Admin function to tidy the Geocube Database.</span>
<span class="sd">    Remove all the entities that are not linked to any dataset.</span>
<span class="sd">    Should be used with caution when no ingestion or indexation task is in progress.</span>

<span class="sd">    Args:</span>
<span class="sd">        aois: remove the pending AOI</span>
<span class="sd">        records: remove the pending Records</span>
<span class="sd">        variables: remove the pending Variables</span>
<span class="sd">        instances: remove the pending Instances</span>
<span class="sd">        containers: remove the pending Containers</span>
<span class="sd">        consolidation_params: remove the pending ConsolidationParams</span>
<span class="sd">        simulate: if True no operation is performed. Only the number of entities that would have been deleted</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_admin_tidy</span><span class="p">(</span><span class="n">aois</span><span class="p">,</span> <span class="n">records</span><span class="p">,</span> <span class="n">variables</span><span class="p">,</span> <span class="n">instances</span><span class="p">,</span> <span class="n">containers</span><span class="p">,</span> <span class="n">consolidation_params</span><span class="p">,</span> <span class="n">simulate</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h2 id="geocube.Admin.admin_update_datasets" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">admin_update_datasets</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">records</span><span class="p">,</span> <span class="n">dformat</span><span class="p">,</span> <span class="n">min_out</span><span class="p">,</span> <span class="n">max_out</span><span class="p">,</span> <span class="n">exponent</span><span class="p">,</span> <span class="n">simulate</span><span class="p">)</span></code>

</h2>


    <div class="doc doc-contents ">

        <p>Admin function to update some sensitive information of datasets referenced by an instance and a list of records</p>


<table class="field-list">
  <colgroup>
    <col class="field-name" />
    <col class="field-body" />
  </colgroup>
  <tbody valign="top">
    <tr class="field">
      <th class="field-name">Parameters:</th>
      <td class="field-body">
        <ul class="first simple">
            <li>
              <b><code>instance</code></b>
                  (<code><span title="typing.Union">Union</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="geocube.entities.VariableInstance" href="../../entities/variable-reference/#geocube.entities.VariableInstance">VariableInstance</a>]</code>)
              –
              <div class="doc-md-description">
                <p>select the datasets that are referenced by this instance</p>
              </div>
            </li>
            <li>
              <b><code>records</code></b>
                  (<code><span title="typing.List">List</span>[<span title="typing.Union">Union</span>[<span title="str">str</span>, <a class="autorefs autorefs-internal" title="geocube.entities.Record" href="../../entities/record-reference/#geocube.entities.Record">Record</a>]]</code>)
              –
              <div class="doc-md-description">
                <p>select the datasets that are referenced by these records</p>
              </div>
            </li>
            <li>
              <b><code>dformat</code></b>
                  (<code><span title="typing.Union">Union</span>[<span title="typing.Dict">Dict</span>, <span title="typing.Tuple">Tuple</span>, <span title="str">str</span>]</code>)
              –
              <div class="doc-md-description">
                <p>new dataformat</p>
              </div>
            </li>
            <li>
              <b><code>min_out</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>new min_out</p>
              </div>
            </li>
            <li>
              <b><code>max_out</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>new max_out</p>
              </div>
            </li>
            <li>
              <b><code>exponent</code></b>
                  (<code><span title="float">float</span></code>)
              –
              <div class="doc-md-description">
                <p>new exponent</p>
              </div>
            </li>
            <li>
              <b><code>simulate</code></b>
                  (<code><span title="bool">bool</span></code>)
              –
              <div class="doc-md-description">
                <p>if True, no operation is performed. Only display the datasets that would have been updated.</p>
              </div>
            </li>
        </ul>
      </td>
    </tr>
  </tbody>
</table>

            <details class="quote">
              <summary>Source code in <code>geocube/admin.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">admin_update_datasets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">instance</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">VariableInstance</span><span class="p">],</span>
                          <span class="n">records</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Union</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">entities</span><span class="o">.</span><span class="n">Record</span><span class="p">]],</span>
                          <span class="n">dformat</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">Dict</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="nb">str</span><span class="p">],</span> <span class="n">min_out</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">max_out</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                          <span class="n">exponent</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">simulate</span><span class="p">:</span> <span class="nb">bool</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Admin function to update some sensitive information of datasets referenced by an instance and a list of records</span>

<span class="sd">    Args:</span>
<span class="sd">        instance: select the datasets that are referenced by this instance</span>
<span class="sd">        records: select the datasets that are referenced by these records</span>
<span class="sd">        dformat: new dataformat</span>
<span class="sd">        min_out: new min_out</span>
<span class="sd">        max_out: new max_out</span>
<span class="sd">        exponent: new exponent</span>
<span class="sd">        simulate: if True, no operation is performed. Only display the datasets that would have been updated.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_admin_update_datasets</span><span class="p">(</span><span class="n">instance</span><span class="p">,</span> <span class="n">records</span><span class="p">,</span> <span class="n">dformat</span><span class="p">,</span> <span class="n">min_out</span><span class="p">,</span> <span class="n">max_out</span><span class="p">,</span> <span class="n">exponent</span><span class="p">,</span> <span class="n">simulate</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../consolidater-reference/" class="btn btn-neutral float-left" title="Consolidater"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../entities/variable-reference/" class="btn btn-neutral float-right" title="Variable">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../consolidater-reference/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../entities/variable-reference/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../../..";</script>
    <script src="../../../js/theme_extra.js"></script>
    <script src="../../../js/theme.js"></script>
      <script src="../../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
